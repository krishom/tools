<!doctype html>
<html>
  <head>
    <title>Safeway J4U Coupon Clipper</title>
    <style>
      body {
        font-family: arial, sans-serif;
      }
      img {
        box-shadow: 2px 2px 2px;
      }
    </style>
  </head>
  <body>
    <h3>Bookmarklet</h3>
    Drag this link to your bookmarks bar: <a href="javascript:!function(){var e='/foru/coupons-deals.html';window.location.href.indexOf(e)<0?window.location.replace('https://www.safeway.com'+e):function e(){var n=document.querySelectorAll('.btn-primary');if(0<n.length){document.querySelector('.btn.load-more').dispatchEvent(new Event('click'));let t=0;n.forEach(e=>setTimeout(()=>e.dispatchEvent(new Event('click')),t+=250)),setTimeout(e,t+250)}}()}();">Just4U</a>
    <br><br>
    Example:<br>
    <img src="bookmarklet.png">
    <h3>Instructions</h3>
    <ol>
      <li>Log in to the <a href="https://www.safeway.com/account/sign-in.html">safeway.com Coupon Center</a></li>
      <li>When the page loads, click the "Just4U" bookmarklet you created above.</li>
      <li>Each item will be added to your card sequentially.</li>
    </ol>
    <h3>Uncompiled Source</h3>
    <pre>
(function () {
  const url = "/foru/coupons-deals.html"
  if (window.location.href.indexOf(url) < 0) {
    window.location.replace("https://www.safeway.com" + url)
    return
  }
  function clipAll() {
    const interval = 250
    const buttons = document.querySelectorAll(".btn-primary")
    if (buttons.length > 0) {
      document.querySelector(".btn.load-more").dispatchEvent(new Event("click"))
      let delay = 0
      buttons.forEach((btn) =>
        setTimeout(
          () => btn.dispatchEvent(new Event("click")),
          (delay += interval)
        )
      )
      setTimeout(clipAll, delay + interval)
    }
  }
  clipAll()
})()
    </pre>
  </body>
</html>
